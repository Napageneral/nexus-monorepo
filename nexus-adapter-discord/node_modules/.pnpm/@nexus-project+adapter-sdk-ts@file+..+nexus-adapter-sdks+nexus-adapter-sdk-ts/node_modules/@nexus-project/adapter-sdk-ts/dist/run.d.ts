import { type AdapterLogger } from "./logger.js";
import { type AdapterAccount, type AdapterHealth, type AdapterInfo, type DeliveryResult, type NexusEvent, type SendRequest } from "./protocol.js";
import { type AdapterRuntimeContext } from "./runtime-context.js";
import { type StreamHandlers } from "./stream.js";
export type AdapterContext = {
    signal: AbortSignal;
    runtime: AdapterRuntimeContext | null;
    log: AdapterLogger;
    stdout: NodeJS.WriteStream;
    stderr: NodeJS.WriteStream;
};
export type AdapterDefinition = {
    info: () => AdapterInfo | Promise<AdapterInfo>;
    monitor?: (ctx: AdapterContext, args: {
        account: string;
    }, emit: (e: NexusEvent) => void) => void | Promise<void>;
    backfill?: (ctx: AdapterContext, args: {
        account: string;
        since: Date;
    }, emit: (e: NexusEvent) => void) => void | Promise<void>;
    send?: (ctx: AdapterContext, req: SendRequest) => DeliveryResult | Promise<DeliveryResult>;
    health?: (ctx: AdapterContext, args: {
        account: string;
    }) => AdapterHealth | Promise<AdapterHealth>;
    accounts?: (ctx: AdapterContext) => AdapterAccount[] | Promise<AdapterAccount[]>;
    stream?: StreamHandlers;
};
export type RunAdapterOptions = {
    argv?: string[];
    env?: NodeJS.ProcessEnv;
    stdin?: NodeJS.ReadableStream;
    stdout?: NodeJS.WriteStream;
    stderr?: NodeJS.WriteStream;
    requireRuntimeContext?: boolean;
    validateOutput?: boolean;
    patchConsole?: boolean;
    installSignalHandlers?: boolean;
};
export declare function runAdapter(adapter: AdapterDefinition, opts?: RunAdapterOptions): Promise<number>;
